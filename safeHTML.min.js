/*!
safeHTML v1.1
Author: Abdul Mannaf
Source: https://github.com/AbdulMannaf/safeHTML
*/
!function(e){var r=["LOWERCASE","UPPERCASE"],a="&lt;",t="&gt;",n="<",i=">",s="'",o=r[0],f=r[0],c="",l="",u=!1,p=!0,y=!1,v={"#text":[],a:["href"],b:[],br:[],strong:[],i:[],em:[],u:[],ins:[],s:[],del:[],strike:[],q:[],small:[],big:[],sup:[],sub:[]},A={code:[],pre:[],script:[],style:[]},T=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],m=["#text","td","th"],E=["!doctype","html","head","body","img","script","iframe","object","applet","source","embed","frame","style","track"],b=["#comment","#text"];function g(r,a){var t=r;return a?r.search(/^SAFE_HTML_/i)>-1&&"doctype"==(t=r.slice(10)).toLowerCase()&&(t="!"+t):(t=r.toLowerCase(),e.inArray(t,E)>-1&&(t="!doctype"==t?"SAFE_HTML_DOCTYPE":"SAFE_HTML_"+t)),d(t,o)}function h(r){var a=e.type(r);if("object"===a){for(var t in r)if(r.hasOwnProperty(t)){var v=t.toUpperCase();switch(v){case"QUOTATION":s=r[t];break;case"ENTITIESENCODE":u=r[t];break;case"KEEPATTRIBUTES":p=r[t];break;case"TAGNAME":o=r[t];break;case"ATTRIBUTENAME":f=r[t];break;case"ATTRIBUTEVALUE":c=r[t];break;case"TEXT":l=r[t];break;case"SELFCLOSINGTAGS":case"EMPTYTAGS":var A=r[t],E=e.type(A),h=[];"array"===E?h=A:"string"===E&&(h=[A]),"EMPTYTAGS"==v?m=h:"SELFCLOSINGTAGS"==v&&(T=h);break;case"TAGOPEN":n=r[t];break;case"TAGCLOSE":i=r[t];break;case"MINIFY":y=!!r[t];break;default:console.warn("Invalid option "+t+" : "+r[t])}}}else"undefined"!==a&&console.warn("Options must object. "+a+" type provided.");T.push("SAFE_HTML_DOCTYPE");for(let e=0;e<T.length;e++)T[e]=d(g(T[e]),o);for(let e=0;e<m.length;e++)m[e]=d(g(m[e]),o);for(let e=0;e<b.length;e++)b[e]=d(g(b[e]),o)}function d(e,a){return(a=a.toUpperCase())==r[0]?e.toLowerCase():a==r[1]?e.toUpperCase():e}function C(r,a){if("object"!==e.type(r))r=a;var t={};for(var n in r)if(r.hasOwnProperty(n)){var i=r[n],s=e.type(i);if(n=g(n),"array"===s){var o=[];i.forEach(e=>{o.push(d(e,f))}),t[n]=o}else t[n]="string"===s&&""!=i?[d(i,f)]:[]}return t}function L(e,r){return e=d(e,f),""==(r=d(r,c))?" "+e:" "+e+"="+s+r.replace(new RegExp(s,"gi"),function(e){return"&#"+e.charCodeAt(0)+";"})+s}function k(r,s){var o="";return"#comment"==r.toLowerCase()?(o="!--"+s+"--",o=u?a+o+t:n+o+i):(o=e.trim(d(s,l)),y&&(o=o.replace(/(?:\r\n|\r|\n)/g," ").replace(/\s\s+/g," "))),o}function w(r,s,c){var l,y;l=r,E.forEach(e=>{var r=g(e);if(y)var a=r,t=e;else a=e,t=r;var n=new RegExp("(<"+a+" [^>]*>|<"+a+">)","gi");l=l.replace(n,function(e){var r="<";return r+=t,r+=e.slice(a.length+1)});var i=new RegExp("(</"+a+">)","gi");l=l.replace(i,function(){return"</"+t+">"})}),r=l;var v=e.parseHTML(r,document,!0),A="";for(var h in v)if(v.hasOwnProperty(h)){var C=v[h],O=d(C.nodeName,o);C.childNodes.length;if("keep"==c)if(O in s||"*"in s)if(e.inArray(O,b)>-1)A+=k(O,C.textContent);else{var S=d(C.tagName,o),N=C.innerHTML,P="";if(C.attributes.length>0){var M=C.attributes;for(var x in M)if(M.hasOwnProperty(x)){var I=d((F=M[x]).name,f);if(S in s)var H=s[S];else H=s["*"];(e.inArray("*",H)>-1||e.inArray(I,H)>-1)&&(P+=L(I,F.value))}}var G=w(N,s,c);(""!=P||""!=G||e.inArray("*",m)>-1||e.inArray(S,m)>-1||e.inArray(S,T)>-1)&&(A+=n+g(S,!0)+P+i+G,e.inArray(S,T)<0&&(A+=n+"/"+g(S,!0)+i))}else if(u)if(e.inArray(O,b)>-1)A+=k(O,C.textContent);else{S=d(C.tagName,o),N=C.innerHTML,P="";if(p&&C.attributes.length>0){M=C.attributes;for(var x in M){if(M.hasOwnProperty(x))P+=L(I=d((F=M[x]).name,f),F.value)}}G=w(N,s,c);A+=a+g(S,!0)+P+t+G,e.inArray(S,T)<0&&(A+=a+"/"+g(S,!0)+t)}else e.inArray(O,b)<0&&(A+=k(O,C.textContent));else if("remove"==c)if(O in s||"*"in s){if(O in s)var U=s[O];else U=s["*"];if(e.inArray(O,b)>-1)(U.length>0||u)&&(A+=k(O,C.textContent));else if(U.length>0){S=d(C.tagName,o),N=C.innerHTML,P="";if(e.inArray("*",U)<0){M=C.attributes;for(var x in M)if(M.hasOwnProperty(x)){I=d((F=M[x]).name,f);e.inArray(I,U)<0&&(P+=L(I,F.value))}}G=w(N,s,c);if(u)var R=a,_=t;else R=n,_=i;A+=R+g(S,!0)+P+_+G,e.inArray(S,T)<0&&(A+=R+"/"+g(S,!0)+_)}else{N=C.innerHTML;if(u){S=d(C.tagName,o),G=w(N,s,c),P="",M=C.attributes;for(var x in M){if(M.hasOwnProperty(x))P+=L(I=d((F=M[x]).name,f),F.value)}A+=a+g(S,!0)+P+t+G,e.inArray(S,T)<0&&(A+=a+"/"+g(S,!0)+t)}else A+=w(N,s,c)}}else if(e.inArray(O,b)>-1)A+=k(O,C.textContent);else{S=d(C.tagName,o),N=C.innerHTML,P="";if(C.attributes.length>0){M=C.attributes;for(var x in M){var F;if(M.hasOwnProperty(x))P+=L(I=d((F=M[x]).name,f),F.value)}}G=w(N,s,c);(""!=P||""!=G||e.inArray("*",m)>-1||e.inArray(S,m)>-1||e.inArray(S,T)>-1)&&(A+=n+g(S,!0)+P+i+G,e.inArray(S,T)<0&&(A+=n+"/"+g(S,!0)+i))}}return A}e.fn.keepTags=function(e,r,a){return h(a),w(e,C(r,v),"keep")},e.fn.removeTags=function(e,r,a){return h(a),w(e,C(r,A),"remove")}}(jQuery);